- name: Keyrings - create folder if it doesn't exist
  become: true
  ansible.builtin.file:
    path: '/etc/apt/keyrings'
    state: directory
    mode: 0755
    owner: '{{ user }}'
  tags:
    - discord
  when: ansible_os_family == "Debian"

- name: Discord - Add key
  ansible.builtin.apt_key:
    url: https://deb.beekeeperstudio.io/beekeeper.key
    id: beekeeper.key
    state: present

- name: Discord - PPA setting
  become: true
  ansible.builtin.command: echo "deb https://deb.beekeeperstudio.io stable main" | tee /etc/apt/sources.list.d/beekeeper-studio-app.list
  tags:
    - discord
  when: ansible_os_family == "Debian"

- name: Discord apt installation
  become: true
  ansible.builtin.apt:
    update_cache: true
    name:
      - beekeeper-studio
  tags:
    - discord
  when: ansible_os_family == "Debian"

- name: Install Discord from the AUR
  become: true
  ansible.builtin.command: paru --noconfirm -S discord
  tags:
    - discord
  when: ansible_os_family == "Archlinux"
